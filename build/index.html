
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>WinMAGI API DLL Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;vb&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="vb">vb</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#pre-requisites" class="toc-h1 toc-link" data-title="Pre-requisites">Pre-requisites</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#currently-supported-entity-types" class="toc-h2 toc-link" data-title="Currently supported entity types">Currently supported entity types</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#important-information" class="toc-h1 toc-link" data-title="Important information">Important information</a>
          </li>
          <li>
            <a href="#registering-the-library" class="toc-h1 toc-link" data-title="Registering the library">Registering the library</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#important-api-details" class="toc-h1 toc-link" data-title="Important API Details">Important API Details</a>
          </li>
          <li>
            <a href="#factories" class="toc-h1 toc-link" data-title="Factories">Factories</a>
          </li>
          <li>
            <a href="#customers" class="toc-h1 toc-link" data-title="Customers">Customers</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#generate-the-customer-object" class="toc-h2 toc-link" data-title="Generate the Customer object">Generate the Customer object</a>
                  </li>
                  <li>
                    <a href="#get-customers" class="toc-h2 toc-link" data-title="Get Customers">Get Customers</a>
                  </li>
                  <li>
                    <a href="#create-a-customer" class="toc-h2 toc-link" data-title="Create a Customer">Create a Customer</a>
                  </li>
                  <li>
                    <a href="#update-a-customer" class="toc-h2 toc-link" data-title="Update a Customer">Update a Customer</a>
                  </li>
                  <li>
                    <a href="#delete-a-customer" class="toc-h2 toc-link" data-title="Delete a Customer">Delete a Customer</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#customer-addresses" class="toc-h1 toc-link" data-title="Customer Addresses">Customer Addresses</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#generate-the-customer-object-2" class="toc-h2 toc-link" data-title="Generate the Customer object">Generate the Customer object</a>
                  </li>
                  <li>
                    <a href="#get-customer-addresses" class="toc-h2 toc-link" data-title="Get Customer Addresses">Get Customer Addresses</a>
                  </li>
                  <li>
                    <a href="#create-a-customer-address" class="toc-h2 toc-link" data-title="Create a Customer Address">Create a Customer Address</a>
                  </li>
                  <li>
                    <a href="#update-a-customer-address" class="toc-h2 toc-link" data-title="Update a Customer Address">Update a Customer Address</a>
                  </li>
                  <li>
                    <a href="#delete-a-customer-address" class="toc-h2 toc-link" data-title="Delete a Customer Address">Delete a Customer Address</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#sales-orders" class="toc-h1 toc-link" data-title="Sales Orders">Sales Orders</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#generate-the-sales-order-object" class="toc-h2 toc-link" data-title="Generate the Sales Order object">Generate the Sales Order object</a>
                  </li>
                  <li>
                    <a href="#get-sales-orders" class="toc-h2 toc-link" data-title="Get Sales Orders">Get Sales Orders</a>
                  </li>
                  <li>
                    <a href="#create-a-sales-order" class="toc-h2 toc-link" data-title="Create a Sales Order">Create a Sales Order</a>
                  </li>
                  <li>
                    <a href="#update-a-sales-order" class="toc-h2 toc-link" data-title="Update a Sales Order">Update a Sales Order</a>
                  </li>
                  <li>
                    <a href="#delete-a-sales-order" class="toc-h2 toc-link" data-title="Delete a Sales Order">Delete a Sales Order</a>
                  </li>
                  <li>
                    <a href="#get-salesman" class="toc-h2 toc-link" data-title="Get Salesman">Get Salesman</a>
                  </li>
                  <li>
                    <a href="#get-shipvia" class="toc-h2 toc-link" data-title="Get ShipVia">Get ShipVia</a>
                  </li>
                  <li>
                    <a href="#get-taxcode" class="toc-h2 toc-link" data-title="Get TaxCode">Get TaxCode</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#initoleobject-magi-license-server-errors" class="toc-h2 toc-link" data-title="InitOleObject - MAGI License Server errors">InitOleObject - MAGI License Server errors</a>
                  </li>
                  <li>
                    <a href="#general-errors" class="toc-h2 toc-link" data-title="General errors">General errors</a>
                  </li>
                  <li>
                    <a href="#create-update-field-validation-errors" class="toc-h2 toc-link" data-title="Create / Update - Field validation errors">Create / Update - Field validation errors</a>
                  </li>
                  <li>
                    <a href="#delete-relationship-constraints" class="toc-h2 toc-link" data-title="Delete - Relationship constraints">Delete - Relationship constraints</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the WinMAGI API DLL documentation. You can use our DLL to access your WinMAGI data from third-party applications locally on your server. With this API, 
you can create, update, and delete customers and shipping addresses, create sales orders, and query all sorts 
of data in your WinMAGI database.</p>

<aside class="success">
IMPORTANT: This is a local server DLL-based API. It is intended to allow your own yet-to-be-developed middleware to connect your cloud-based
applications to your locally-hosted WinMAGI system. 

The WinMAGI API is not cloud-based and is not accessible from outside
your network.
</aside>

<p>Another option is to have MAGI develop a direct integration with your cloud-based systems. This will allow greater flexibility and feature access and does not require you to have 
an in-house or third-party developer to develop an integration for you.</p>

<p>If there is data or a function you would like exposed in the API, contact us at <a href="mailto:support@magi-erp.com">support@magi-erp.com</a> </p>

<aside class="danger">
This API requires knowledge of WinMAGI's System Dictionary. 
You will frequently need to access the WinMAGI System Dictionary while developing your intergration.
</aside>
<h1 id='pre-requisites'>Pre-requisites</h1>
<ul>
<li>MAGI License Server version 101 or later</li>
<li>WinMAGI build V821495 or later</li>
<li>Register the WinMAGI.exe</li>
<li>A valid WinMAGI license authorizing at least one of the supported entity types</li>
<li>An available concurrent user seat or limited user seat </li>
<li>A software developer to create the middleware that integrates your third-party applications with WinMAGI</li>
</ul>
<h3 id='currently-supported-entity-types'>Currently supported entity types</h3>
<ul>
<li>Customers (includes addresses)</li>
<li>Sales Orders</li>
</ul>

<aside class="success">
Each entity type is licensed separately. 
</aside>
<h1 id='important-information'>Important information</h1>
<ul>
<li>Each instance of WinMAGI.ApiBase consumes a limited user.</li>
<li>Each instance of WinMAGI.ApiBase will be present in the MAGI License Server for management purposes.</li>
<li>Releasing the WinMAGI.ApiBase object will release the consumed user seat.</li>
<li>After installing a new WinMAGI build, it may be necessary to unregister and register the WinMAGI.exe again</li>
<li>Supported fields and validations, in most cases, come from your WinMAGI System Dictionary. 

<ul>
<li>It would be wise to create a wrapper that limits what third-party applications can do with the API.</li>
</ul></li>
</ul>
<h1 id='registering-the-library'>Registering the library</h1>
<blockquote>
<p>You must first register the WinMAGI API library on the machine(s) that will consume it.</p>
</blockquote>

<p>Open an elevated command prompt, navigate to the directory containing your WinMAGI.exe, and type winmagi.exe /regserver</p>

<p>You may unregister in the same way using the /unregserver flag.</p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<div class="highlight"><pre class="highlight vb tab-vb"><code><span class="c1">' Initialize the object, connect with the license server, validate the license and available users</span>
<span class="c1">' objWinMAGI.InitOleObject("&lt;path\to\winmagi&gt;", "&lt;DATA directory name&gt;")</span>

<span class="c1">' InitOleObject can take a few seconds as it communicates with the MAGI License Server asynchronously.</span>

<span class="k">Dim</span> <span class="nv">objWinMAGI</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"WinMAGI.ApiBase"</span><span class="p">)</span>
<span class="k">Dim</span> <span class="nv">lnResult</span> <span class="ow">As</span> <span class="n">Int16</span> <span class="o">=</span> <span class="n">objWinMAGI</span><span class="p">.</span><span class="n">InitOleObject</span><span class="p">(</span><span class="s">"c:\winmagi"</span><span class="p">,</span> <span class="s">"DATA"</span><span class="p">)</span>  

<span class="k">If</span> <span class="n">lnResult</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>

    <span class="c1">' Wait for the property lLoginResponseReceived to indicate successful login to the MAGI License Server</span>
    <span class="k">Do</span> <span class="k">While</span> <span class="n">objWinMAGI</span><span class="p">.</span><span class="n">lLoginResponseReceived</span> <span class="o">=</span> <span class="k">False</span>
        <span class="n">System</span><span class="p">.</span><span class="n">Threading</span><span class="p">.</span><span class="n">Thread</span><span class="p">.</span><span class="n">CurrentThread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">Loop</span>

    <span class="nb">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="s">"Successful login!"</span><span class="p">)</span>

    <span class="c1">' Do stuff</span>
<span class="k">Else</span>
    <span class="c1">' Error with the login or authentication process</span>
    <span class="nb">Console</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">objWinMAGI</span><span class="p">.</span><span class="n">LastErrorText</span><span class="p">)</span>
<span class="k">End</span> <span class="k">If</span>
</code></pre></div>
<p>Authentication involves communication with your WinMAGI License Server to obtain license data including users 
and authorized modules.</p>

<p>Upon successful login to the MAGI License Server, your API user will be shown in the concurrent users list. </p>

<p>Integration with the license server enables visibility into the processes that may be accessing the WinMAGI data. 
This is useful for having the ability to block API users from accessing the system WinMAGI maintenance and build upgrades.</p>

<p>Each instance of ApiBase consumes one concurrent Limited User rather than a full user seat.</p>

<p>One Limited User should be sufficient to interface with WinMAGI from your middleware. </p>

<p>However, if you need multi-threading 
capabilities or would like to run instances from multiple machines, additional Limited Users may be purchased.</p>
<h1 id='important-api-details'>Important API Details</h1>
<ul>
<li><p>Data is queried by passing a set of fields in JSON format. </p>

<ul>
<li>Supported fields are any fields in your WinMAGI System Dictionary for the table you are querying.</li>
<li>Sales Orders have a limited set of supported fields.</li>
</ul></li>
<li><p>Wildcards (% and _) are supported.</p></li>
<li><p>JSON fields MUST be all CAPS</p></li>
<li><p>Multiple fields will be ANDed to find a result that matches all criteria provided</p></li>
<li><p>Returns</p>

<ul>
<li>Results found: a JSON array </li>
<li>No results found: An empty JSON object</li>
<li>Error: An empty string. Query objCustomer.LastErrorText for details.</li>
</ul></li>
<li><p>Validations</p>

<ul>
<li>Validation of values for an entity is controlled by the &quot;When&quot; and &quot;Valid&quot; methods in your WinMAGI System Dictionary for the table in question.</li>
<li>Any field in the dictionary may be supplied in your JSON-formatted object.

<ul>
<li>Only select fields are supported for Sales Orders.</li>
</ul></li>
<li>If a supplied field&#39;s &quot;When&quot; method evaluates to false, no changes will be made to the object.</li>
<li>If the value you provide results in the field&#39;s &quot;Valid&quot; method evaluating to false, no changes will be made. </li>
<li>Details of validation failure will be in the LastErrorText property.</li>
</ul></li>
</ul>
<h1 id='factories'>Factories</h1>
<p>Each instance of WinMAGI.ApiBase can generate one instance of each entity type.</p>

<p>For example, you may call objWinMAGI.mthGetCustomerObject() and objWinMAGI.mthGetSalesOrderObject() which will 
 allow you to create a customer and an order with one authenticated session while consuming only a single limited user.</p>

<p>Our intention is that you leave objWinMAGI in memory and logged into the license server as long as possible.</p>
<h1 id='customers'>Customers</h1>
<p>The customer object enables Customer and Customer Address actions that will run through the WinMAGI code for validation, 
consistency, and concurrency with WinMAGI users.</p>
<h2 id='generate-the-customer-object'>Generate the Customer object</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">objCustomer</span> <span class="o">=</span> <span class="n">objWinMAGI</span><span class="p">.</span><span class="n">mthGetCustomerObject</span><span class="p">()</span>

<span class="c1">' Errors will return null, and a message will be present in objWinMAGI.LastErrorText</span>
</code></pre></div>
<p>Grab a customer object from the Customer Factory</p>
<h2 id='get-customers'>Get Customers</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomers</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Get all customers</span>
<span class="n">jsonCustomers</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthFindCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">%</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   

<span class="c1">' Get customer with company exactly matching Walmart (case-insensitive)</span>
<span class="n">jsonCustomers</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthFindCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">COMPANY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Walmart</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   

<span class="c1">' Get customer with company exactly matching Walmart and city matching Bentonville</span>
<span class="n">jsonCustomers</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthFindCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">COMPANY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Walmart</span><span class="se">""</span><span class="s">, 
</span><span class="se">""</span><span class="s">CITY</span><span class="se">""</span><span class="s">: </span><span class="se">""</span><span class="s">Bentonville</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>    
</code></pre></div>
<blockquote>
<p>This method returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WALMART"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Walmart"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bentonville"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AR"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"72712"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"406 S Walton Blvd"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTOMER table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BESTBUY"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Best Buy"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2650 E Belt Line SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTOMER table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all customers matching JSON-formatted criteria you provide.</p>
<h3 id='json-formatted-parameters'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>false</td>
<td>If supplied, return customers matching this CUSTID</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>If supplied, return customers matching this Company</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTOMER table</td>
</tr>
</tbody></table>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h2 id='create-a-customer'>Create a Customer</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Create a customer</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthCreateCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">, 
</span><span class="se">""</span><span class="s">COMPANY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI Software</span><span class="se">""</span><span class="s">,</span><span class="se">""</span><span class="s">CITY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Grand Rapids</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">STATE</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MI</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the newly-created JSON-formatted customer object structured like this if successful:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTOMER table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful attempts return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Create a WinMAGI customer.</p>

<ul>
<li><p>Only one customer can be created with each call to mthCreateCustomer</p></li>
<li><p>Fields you may provide can be found in the WinMAGI System Dictionary for the CUSTOMER table on the Fields tab</p></li>
<li><p>CUSTID must be unique and UPPER CASE</p></li>
<li><p>Successful creation returns the complete customer object in JSON. Any other result indicates an error. Check LastErrorText.</p></li>
<li><p>Fields MUST be UPPER CASE</p></li>
<li><p>Validations from your WinMAGI System Dictionary will be evaluated</p></li>
</ul>
<h3 id='json-formatted-parameters-2'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Unique, Upper-cased string customer ID</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>Company name</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>Company address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Company city</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>Company state</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Company zip</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTOMER table</td>
</tr>
</tbody></table>
<h2 id='update-a-customer'>Update a Customer</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Update an existing customer</span>
<span class="c1">' This code updates the CITY to Traverse City for customer MAGI</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthUpdateCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">,</span><span class="se">""</span><span class="s">CITY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Traverse City</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the JSON-formatted customer object structured like this if successful:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Traverse City"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTOMER table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful attempts return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Update a WinMAGI customer.</p>

<ul>
<li><p>CUSTID is REQUIRED and must be UPPER CASE</p></li>
<li><p>Only one customer can be created with each call</p></li>
<li><p>Fields you may provide can be found in the WinMAGI System Dictionary for the CUSTOMER table on the Fields tab</p></li>
<li><p>Successful creation returns the complete customer object in JSON. Any other result indicates an error. Check LastErrorText.</p></li>
<li><p>Fields MUST be UPPER CASE</p></li>
<li><p>Validations from your WinMAGI System Dictionary will be evaluated</p></li>
</ul>
<h3 id='json-formatted-parameters-3'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer ID</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>Company name</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>Company address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Company city</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>Company state</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Company zip</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTOMER table</td>
</tr>
</tbody></table>
<h2 id='delete-a-customer'>Delete a Customer</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Attempt to delete a customer</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthDeleteCustomer</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>Successful calls return the following:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DELETED"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful calls return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Delete a WinMAGI customer.</p>

<ul>
<li><p>CUSTID is REQUIRED and must be UPPER CASE</p></li>
<li><p>Deleting a customer is not permitted in most cases due to dependencies elsewhere in the system.</p></li>
</ul>
<h3 id='json-formatted-parameters-4'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer ID</td>
</tr>
</tbody></table>
<h1 id='customer-addresses'>Customer Addresses</h1>
<p>The customer object enables Customer and Customer Address actions that will run through the WinMAGI code for validation, 
consistency, and concurrency with WinMAGI users.</p>
<h2 id='generate-the-customer-object-2'>Generate the Customer object</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">objCustomer</span> <span class="o">=</span> <span class="n">objWinMAGI</span><span class="p">.</span><span class="n">mthGetCustomerObject</span><span class="p">()</span>

<span class="c1">' Errors will return null, and a message will be present in objWinMAGI.LastErrorText</span>
</code></pre></div>
<p>Grab a customer object from the Customer Factory</p>
<h2 id='get-customer-addresses'>Get Customer Addresses</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonAddresses</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Get all customer addresses for customer MAGI</span>
<span class="n">jsonAddresses</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthFindAddress</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2660 Horizon Dr SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTADDR table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Traverse City"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49686"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2211 North U.S. 31 North"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTADDR table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight plaintext"><code>' Get specific customer address by City (case-insensitive)
jsonAddresses = objCustomer.mthFindAddress("{""CUSTID"":""MAGI"", ""CITY"":""Grand Rapids""}")   
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2660 Horizon Dr SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTADDR table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all customer addresses matching JSON-formatted criteria you provide.</p>
<h3 id='json-formatted-parameters-5'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>false</td>
<td>If supplied, return customers matching this CUSTID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>false</td>
<td>If supplied, return customers matching this SHIPID</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>If supplied, return customers matching this Address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>If supplied, return customers matching this City</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTADDR table</td>
</tr>
</tbody></table>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h2 id='create-a-customer-address'>Create a Customer Address</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Create a customer address</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthAddAddress</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">SHIPID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">1</span><span class="se">""</span><span class="s">, 
</span><span class="se">""</span><span class="s">COMPANY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI Software</span><span class="se">""</span><span class="s">,</span><span class="se">""</span><span class="s">CITY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Grand Rapids</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">STATE</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MI</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the newly-created JSON-formatted customer address object structured like this if successful:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTOMER table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful attempts return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Create a WinMAGI customer address.</p>

<ul>
<li><p>Only one customer address can be created with each call to mthAddAddress</p></li>
<li><p>Fields you may provide can be found in the WinMAGI System Dictionary for the CUSTADDR table on the Fields tab</p></li>
<li><p>CUSTID must already exist and be UPPER CASE</p></li>
<li><p>SHIPID must be unique and UPPER CASE</p></li>
<li><p>Successful creation returns the new customer address object in JSON. Any other result indicates an error. Check LastErrorText.</p></li>
<li><p>Fields MUST be UPPER CASE</p></li>
<li><p>Validations from your WinMAGI System Dictionary will be evaluated</p></li>
</ul>
<h3 id='json-formatted-parameters-6'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, upper-cased string customer ID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>true</td>
<td>Unique, upper-cased string customer address ID</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>Company name</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>Company address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Company city</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>Company state</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Company zip</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTADDR table</td>
</tr>
</tbody></table>
<h2 id='update-a-customer-address'>Update a Customer Address</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Update an existing customer</span>
<span class="c1">' This code updates the CITY to Traverse City for customer MAGI address record "1"</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthUpdateAddress</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">SHIPID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">1</span><span class="se">""</span><span class="s">,</span><span class="se">""</span><span class="s">CITY</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Traverse City</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the JSON-formatted customer address object structured like this if successful:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Traverse City"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI CUSTADDR table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful attempts return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Update a WinMAGI customer.</p>

<ul>
<li><p>CUSTID is REQUIRED and must be UPPER CASE</p></li>
<li><p>SHIPID is REQUIRED and must be UPPER CASE</p></li>
<li><p>Only one customer address can be updated with each call</p></li>
<li><p>Fields you may provide can be found in the WinMAGI System Dictionary for the CUSTADDR table on the Fields tab</p></li>
<li><p>Successful update returns the complete customer address object in JSON format. Any other result indicates an error. Check LastErrorText.</p></li>
<li><p>Fields MUST be UPPER CASE</p></li>
<li><p>Validations from your WinMAGI System Dictionary will be evaluated</p></li>
</ul>
<h3 id='json-formatted-parameters-7'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer ID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer address ID</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>Company name</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>Company address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Company city</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>Company state</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Company zip</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the CUSTADDR table</td>
</tr>
</tbody></table>
<h2 id='delete-a-customer-address'>Delete a Customer Address</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonCustomer</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Attempt to delete a customer address</span>
<span class="n">jsonCustomer</span> <span class="o">=</span> <span class="n">objCustomer</span><span class="p">.</span><span class="n">mthDeleteAddress</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">SHIPID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">1</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>Successful calls return the following:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DELETED"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful calls return an empty string and assign details to objCustomer.LastErrorText</p>
</blockquote>

<p>Delete a WinMAGI customer address.</p>

<ul>
<li><p>CUSTID is REQUIRED and must be UPPER CASE</p></li>
<li><p>SHIPID is REQUIRED and must be UPPER CASE</p></li>
</ul>
<h3 id='json-formatted-parameters-8'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer ID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>true</td>
<td>Existing, Upper-cased string WinMAGI customer address ID</td>
</tr>
</tbody></table>
<h1 id='sales-orders'>Sales Orders</h1>
<p>The Sales Order object enables Sales Order actions that will run through the WinMAGI code for validation, 
consistency, and concurrency with WinMAGI users.</p>
<h2 id='generate-the-sales-order-object'>Generate the Sales Order object</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">objOrder</span> <span class="o">=</span> <span class="n">objWinMAGI</span><span class="p">.</span><span class="n">mthGetOrderObject</span><span class="p">()</span>

<span class="c1">' Errors will return null, and a message will be present in objWinMAGI.LastErrorText</span>
</code></pre></div>
<p>Grab a Sales Order object from the Sales Order Factory</p>
<h2 id='get-sales-orders'>Get Sales Orders</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonOrders</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Get all sales orders for customer MAGI</span>
<span class="n">jsonOrders</span> <span class="o">=</span> <span class="n">objOrder</span><span class="p">.</span><span class="n">mthFindOrder</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"OENO"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29387"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ORDDATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-18"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"PONUM"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A11091"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2660 Horizon Dr SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI COMAST table"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"LINEITEMS"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"PN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A101"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"QTYORD"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"CUSELL"</span><span class="p">:</span><span class="w"> </span><span class="mf">19.32</span><span class="p">,</span><span class="w">
          </span><span class="s2">"...All other fields in WinMAGI CODET table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"OENO"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29323"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ORDDATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-14"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"PONUM"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A54432"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2660 Horizon Dr SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI COMAST table"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"LINEITEMS"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"PN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A101"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"QTYORD"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"CUSELL"</span><span class="p">:</span><span class="w"> </span><span class="mf">19.32</span><span class="p">,</span><span class="w">
          </span><span class="s2">"...All other fields in WinMAGI CODET table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div><div class="highlight"><pre class="highlight plaintext"><code>' Find sales order by PO (case-insensitive)
jsonOrders = objCustomer.mthFindAddress("{""PONUM"":""A54432""}")   
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"OENO"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29323"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ORDDATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-14"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATUS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"PONUM"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A54432"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2660 Horizon Dr SE"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI COMAST table"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"LINEITEMS"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"PN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A101"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"QTYORD"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"CUSELL"</span><span class="p">:</span><span class="w"> </span><span class="mf">19.32</span><span class="p">,</span><span class="w">
          </span><span class="s2">"...All other fields in WinMAGI CODET table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all sales orders matching JSON-formatted criteria you provide.</p>
<h3 id='json-formatted-parameters-9'>JSON-formatted Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>false</td>
<td>If supplied, return customers matching this CUSTID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>false</td>
<td>If supplied, return customers matching this SHIPID</td>
</tr>
<tr>
<td>ADDRESS</td>
<td>false</td>
<td>If supplied, return customers matching this Address</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>If supplied, return customers matching this City</td>
</tr>
<tr>
<td>PONUM</td>
<td>false</td>
<td>If supplied, return customers matching this Po Number</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the COMAST table</td>
</tr>
</tbody></table>

<p>Multiple fields in the query will return results matching ALL supplied values. </p>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h2 id='create-a-sales-order'>Create a Sales Order</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonOrder</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Create a sales order</span>
<span class="n">jsonOrder</span> <span class="o">=</span> <span class="n">objOrder</span><span class="p">.</span><span class="n">mthCreateOrder</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">CUSTID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">MAGI</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">SHIPID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">1</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">PREPAYAMT</span><span class="se">""</span><span class="s">: 77.28
</span><span class="se">""</span><span class="s">ECORDERID</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">14423</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">LINEITEMS</span><span class="se">""</span><span class="s">:[ {</span><span class="se">""</span><span class="s">PN</span><span class="se">""</span><span class="s">: </span><span class="se">""</span><span class="s">A101</span><span class="se">""</span><span class="s">, </span><span class="se">""</span><span class="s">QTYORD</span><span class="se">""</span><span class="s">: 4, </span><span class="se">""</span><span class="s">CUSELL</span><span class="se">""</span><span class="s">: 19.32, </span><span class="se">""</span><span class="s">TAXABLE</span><span class="se">""</span><span class="s">: false } ]}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the newly-created JSON-formatted sales order object structured like this if successful:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"OENO"</span><span class="p">:</span><span class="w"> </span><span class="s2">"22545"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CUSTID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"SHIPID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ECORDERID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14423"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"PREPAYAMT"</span><span class="p">:</span><span class="w"> </span><span class="mf">77.28</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI COMAST table"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"LINEITEMS"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"PN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A101"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"QTYORD"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
          </span><span class="s2">"CUSELL"</span><span class="p">:</span><span class="w"> </span><span class="mf">19.32</span><span class="p">,</span><span class="w">
          </span><span class="s2">"...All other fields in WinMAGI CODET table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>Unsuccessful attempts return an empty string and assign details to objOrder.LastErrorText</p>
</blockquote>

<p>Create a WinMAGI sales order.</p>

<ul>
<li><p>Only your custom &quot;Z&quot; fields and those listed below are supported.</p></li>
<li><p>You may provide a WinMAGI TaxCode (see TaxCode lookup section), or you may provide leave TAXCODE blank to provide 
TAXES1-4 with TAXACCT1-4</p></li>
<li><p>CUSTID must already exist and be UPPER CASE</p></li>
<li><p>SHIPID must be unique and UPPER CASE if you choose to provide it.</p></li>
<li><p>ECORDERID is required and must be unique. It is intended to be the link to the source system&#39;s order.</p></li>
<li><p>Successful creation returns the new sales order object in JSON format. Any other result indicates an error. Check LastErrorText.</p></li>
<li><p>Fields MUST be UPPER CASE</p></li>
<li><p>Validations from your WinMAGI System Dictionary will be evaluated</p></li>
</ul>

<aside class="warning">
Only your custom "Z" fields and select WinMAGI fields are supported for sales orders! Request additional fields as needed.
</aside>

<aside class="success">
Status "2" (Approved) automatically becomes status "3" (Released) upon saving an order. Use Status "0" for quotes, 
"1" for planned orders, and "3" to release orders.
</aside>
<h3 id='json-formatted-parameters-10'>JSON-formatted Parameters</h3>
<p>SALES ORDER:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>CUSTID</td>
<td>true</td>
<td>Existing, upper-cased string customer ID</td>
</tr>
<tr>
<td>SHIPID</td>
<td>false</td>
<td>Customer shipping address record ID (see Customer Address lookup section above)</td>
</tr>
<tr>
<td>ECORDERID</td>
<td>true</td>
<td>Unique order ID from external source</td>
</tr>
<tr>
<td>COMPANY</td>
<td>false</td>
<td>Override company</td>
</tr>
<tr>
<td>ADDRESS1</td>
<td>false</td>
<td>Override Billing Address 1</td>
</tr>
<tr>
<td>ADDRESS2</td>
<td>false</td>
<td>Override Billing Address 2</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Override Billing City</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>Override Billing State</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Override Billing Zip</td>
</tr>
<tr>
<td>COUNTRY</td>
<td>false</td>
<td>Override Billing Country</td>
</tr>
<tr>
<td>EMAIL</td>
<td>false</td>
<td>Override Billing Email</td>
</tr>
<tr>
<td>PHONE</td>
<td>false</td>
<td>Override Billing Phone</td>
</tr>
<tr>
<td>SCOMPANY</td>
<td>false</td>
<td>Shipping Company (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SCONTACT</td>
<td>false</td>
<td>Shipping Contact (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SPHONE</td>
<td>false</td>
<td>Shipping Phone (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SEMAIL</td>
<td>false</td>
<td>Shipping Email (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SADDRESS1</td>
<td>false</td>
<td>Shipping Address 1 (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SADDRESS2</td>
<td>false</td>
<td>Shipping Address 2 (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SCITY</td>
<td>false</td>
<td>Shipping City (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SSTATE</td>
<td>false</td>
<td>Shipping State (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SZIP</td>
<td>false</td>
<td>Shipping Zip (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>SCOUNTRY</td>
<td>false</td>
<td>Shipping Country (Only if SHIPID is empty)</td>
</tr>
<tr>
<td>LINEITEMS</td>
<td>true</td>
<td>a JSON array of lineitems (see below)</td>
</tr>
<tr>
<td>PONUM</td>
<td>depends</td>
<td>PO Number required depends on your WinMAGI settings</td>
</tr>
<tr>
<td>ENTRYDATE</td>
<td>false</td>
<td>Date of order. Defaults to current date.</td>
</tr>
<tr>
<td>ORDDATE</td>
<td>false</td>
<td>Date of PO</td>
</tr>
<tr>
<td>REQDATE</td>
<td>false</td>
<td>Customer&#39;s requested ship date</td>
</tr>
<tr>
<td>SCHDDATE</td>
<td>false</td>
<td>Scheduled Ship Date</td>
</tr>
<tr>
<td>STATUS</td>
<td>false</td>
<td>Order status. Defaults to &quot;1&quot; (Planned)</td>
</tr>
<tr>
<td>TAXES</td>
<td>false</td>
<td>Tax total</td>
</tr>
<tr>
<td>TAXES1</td>
<td>false</td>
<td>Tax amount for account 1</td>
</tr>
<tr>
<td>TAXES2</td>
<td>false</td>
<td>Tax amount for account 2</td>
</tr>
<tr>
<td>TAXES3</td>
<td>false</td>
<td>Tax amount for account 3</td>
</tr>
<tr>
<td>TAXES4</td>
<td>false</td>
<td>Tax amount for account 4</td>
</tr>
<tr>
<td>TAXFRT</td>
<td>false</td>
<td>Freight taxable?</td>
</tr>
<tr>
<td>PREPAYMENT</td>
<td>false</td>
<td>Amount of prepayment</td>
</tr>
<tr>
<td>CURRENCY</td>
<td>false</td>
<td>Currency code</td>
</tr>
<tr>
<td>TOTAL</td>
<td>false</td>
<td>Order total. Used for automatic AR posting.</td>
</tr>
<tr>
<td>DATE_PAID</td>
<td>false</td>
<td>Date of payment. Used for automatic AR posting.</td>
</tr>
<tr>
<td>SHIPCODE</td>
<td>false</td>
<td>Shipping method from ShipVia table (see ShipVia lookup section below)</td>
</tr>
<tr>
<td>HOLDCODE</td>
<td>false</td>
<td>Order hold code</td>
</tr>
<tr>
<td>MDESC</td>
<td>false</td>
<td>Misc. charge description</td>
</tr>
<tr>
<td>MACCTNO</td>
<td>false</td>
<td>Misc. charge Account</td>
</tr>
<tr>
<td>MCHG</td>
<td>false</td>
<td>Misc. charge Amount</td>
</tr>
<tr>
<td>TAXMISC</td>
<td>false</td>
<td>Misc. charge taxable?</td>
</tr>
<tr>
<td>REMCUSTSVC</td>
<td>false</td>
<td>Customer service remarks</td>
</tr>
<tr>
<td>REMARKS</td>
<td>false</td>
<td>Order remarks</td>
</tr>
<tr>
<td>QOEREMARKS</td>
<td>false</td>
<td>Quote remarks</td>
</tr>
<tr>
<td>SALESMAN</td>
<td>false</td>
<td>Salesman ID (see Salesman lookup section below)</td>
</tr>
<tr>
<td>ZFIELDS</td>
<td>false</td>
<td>Any fields beginning with &quot;Z&quot; which is standard practice for custom fields</td>
</tr>
</tbody></table>

<p>LINEITEMS:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>PN</td>
<td>true</td>
<td>Existing, upper-cased string WinMAGI Part Number</td>
</tr>
<tr>
<td>QTYORD</td>
<td>true</td>
<td>Quantity of item ordered</td>
</tr>
<tr>
<td>CUSELL</td>
<td>true</td>
<td>Selling price per item in customer currency</td>
</tr>
<tr>
<td>TAXABLE</td>
<td>false</td>
<td>Is item taxable?</td>
</tr>
<tr>
<td>REMARKS</td>
<td>false</td>
<td>Item details. Defaults to WinMAGI Item Master remarks.</td>
</tr>
<tr>
<td>ZFIELDS</td>
<td>false</td>
<td>Any fields beginning with &quot;Z&quot; which is standard practice for custom fields</td>
</tr>
</tbody></table>
<h2 id='update-a-sales-order'>Update a Sales Order</h2>
<aside class="warning">
Updating existing sales orders is not yet supported.
</aside>
<h2 id='delete-a-sales-order'>Delete a Sales Order</h2>
<aside class="warning">
Deleting existing sales orders is not yet supported.
</aside>
<h2 id='get-salesman'>Get Salesman</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonResult</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Look up salesman ID</span>
<span class="n">jsonResult</span> <span class="o">=</span> <span class="n">objOrder</span><span class="p">.</span><span class="n">mthFindSalesman</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">NAME</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">Jim R Johnson</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the following JSON-formatted records:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"SALESMAN"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CODE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ALL"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"NAME"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jim R Johnson"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ADDRESS1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12 8th Ave."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"PHONE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"616-555-4456"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"COMPANY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MAGI Software"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CITY"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"STATE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MI"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI SALESMAN table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Look up a salesman&#39;s ID for creating an order</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SALESMAN</td>
<td>false</td>
<td>Salesman Code</td>
</tr>
<tr>
<td>CODE</td>
<td>false</td>
<td>Salesman commission code</td>
</tr>
<tr>
<td>NAME</td>
<td>false</td>
<td>Salesman name</td>
</tr>
<tr>
<td>CITY</td>
<td>false</td>
<td>Salesman city</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Salesman ZIP</td>
</tr>
<tr>
<td>PHONE</td>
<td>false</td>
<td>Salesman phone number</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the SALESMAN table</td>
</tr>
</tbody></table>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h2 id='get-shipvia'>Get ShipVia</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonResult</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Look up ShipVia records</span>
<span class="n">jsonResult</span> <span class="o">=</span> <span class="n">objOrder</span><span class="p">.</span><span class="n">mthFindShipVia</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">DESC</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">UPS Ground</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the following JSON-formatted records:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"SHIPCODE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UPS Ground"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"CARCONTACT"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Jen Smith"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI SHIPVIA table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Look up a ShipVia ID for creating an order</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>SHIPCODE</td>
<td>false</td>
<td>ShipVia Code</td>
</tr>
<tr>
<td>DESC</td>
<td>false</td>
<td>Description</td>
</tr>
<tr>
<td>CARCONTACT</td>
<td>false</td>
<td>Carrier Contact</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the SHIPVIA table</td>
</tr>
</tbody></table>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h2 id='get-taxcode'>Get TaxCode</h2><div class="highlight"><pre class="highlight vb tab-vb"><code><span class="k">Dim</span> <span class="nv">jsonResult</span> <span class="ow">As</span> <span class="kt">String</span>

<span class="c1">' Look up TaxRate records</span>
<span class="n">jsonResult</span> <span class="o">=</span> <span class="n">objOrder</span><span class="p">.</span><span class="n">mthFindTaxRate</span><span class="p">(</span><span class="s">"{</span><span class="se">""</span><span class="s">ZIP</span><span class="se">""</span><span class="s">:</span><span class="se">""</span><span class="s">49546</span><span class="se">""</span><span class="s">}"</span><span class="p">)</span>   
</code></pre></div>
<blockquote>
<p>The above command returns the following JSON-formatted records:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"TAXCODE"</span><span class="p">:</span><span class="w"> </span><span class="s2">"01"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Michigan - Grand Rapids"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ZIP"</span><span class="p">:</span><span class="w"> </span><span class="s2">"49546"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"RATE1"</span><span class="p">:</span><span class="w"> </span><span class="mf">6.000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"RATE2"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"RATE3"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"RATE4"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.000</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC1"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC3"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"DESC4"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ACCT1"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ACCT2"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ACCT3"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ACCT4"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
    </span><span class="s2">"...All other fields in WinMAGI TAXRATE table"</span><span class="p">:</span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Look up a TaxCode to automatically assign tax rates when creating an order</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>TAXCODE</td>
<td>false</td>
<td>TaxRate record ID</td>
</tr>
<tr>
<td>DESC</td>
<td>false</td>
<td>Description</td>
</tr>
<tr>
<td>STATE</td>
<td>false</td>
<td>State</td>
</tr>
<tr>
<td>ZIP</td>
<td>false</td>
<td>Zip code</td>
</tr>
<tr>
<td>COUNTRY</td>
<td>false</td>
<td>Country</td>
</tr>
<tr>
<td>ANY_OTHER_FIELD</td>
<td>false</td>
<td>Any WinMAGI field in the TAXRATE table</td>
</tr>
</tbody></table>

<aside class="success">
Wildcards (% and _) are supported.
</aside>

<aside class="success">
Field values in lookups are not case sensitive
</aside>

<aside class="success">
Multiple fields can be provided. Records that match all values provided will be returned.
</aside>
<h1 id='errors'>Errors</h1>
<aside class="notice">
There are numerous errors you may encounter at every point in the API process. Many of them depend on your unique 
WinMAGI System Dictionary. Ask MAGI for clarification of error messages.
</aside>

<p>Here are some of the most common error messages you may receive in the LastErrorText property. 
This list is not all-inclusive. </p>
<h2 id='initoleobject-magi-license-server-errors'>InitOleObject - MAGI License Server errors</h2>
<table><thead>
<tr>
<th>Error Message</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>License Server date and time do not match this client</td>
<td>Server and client date/time out of sync</td>
</tr>
<tr>
<td>WinMAGI license is NOT valid for use</td>
<td>License is invalid</td>
</tr>
<tr>
<td>WinMAGI license has expired</td>
<td>License is expired</td>
</tr>
<tr>
<td>You are trying to run a WinMAGI version that is newer than your maintenance expiration</td>
<td>Not authorized to run this build version</td>
</tr>
<tr>
<td>Maximum concurrent users exceeded</td>
<td>No available user seats</td>
</tr>
<tr>
<td>The WinMAGI License Server is set to deny access for all users</td>
<td>WinMAGI access is shut down for maintenance</td>
</tr>
<tr>
<td>Company not found</td>
<td>Invalid parameter passed to InitOleObject</td>
</tr>
<tr>
<td>Cannot connect to the WinMAGI License Server at</td>
<td>Communication with License Server was unsuccessful</td>
</tr>
<tr>
<td>Lost connection to the WinMAGI License Server</td>
<td>Connection to the License Server dropped</td>
</tr>
</tbody></table>
<h2 id='general-errors'>General errors</h2>
<table><thead>
<tr>
<th>Error Message</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>Missing data in JSON format</td>
<td>No data passed in or not properly formatted</td>
</tr>
<tr>
<td>No search fields provided</td>
<td>No fields provided in the JSON-formatted parameter</td>
</tr>
<tr>
<td>Module not authorized for use</td>
<td>Trying to use an API module that is not authorized for use</td>
</tr>
</tbody></table>
<h2 id='create-update-field-validation-errors'>Create / Update - Field validation errors</h2>
<table><thead>
<tr>
<th>Error Message</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td><field> validation failed: SySeek(...</td>
<td>Uniqueness constraint violated for field <field></td>
</tr>
</tbody></table>
<h2 id='delete-relationship-constraints'>Delete - Relationship constraints</h2>
<table><thead>
<tr>
<th>Error Message</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>Unable to delete due to dependencies</td>
<td>Dependencies exist in other tables that prevent deletion</td>
</tr>
<tr>
<td>Unable to lock record for delete</td>
<td>Someone is using the record</td>
</tr>
<tr>
<td>Invalid CustId</td>
<td>CUSTID provided does not exist</td>
</tr>
<tr>
<td>Missing CustId</td>
<td>Required CUSTID not provided</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="vb">vb</a>
          </div>
      </div>
    </div>
  </body>
</html>
